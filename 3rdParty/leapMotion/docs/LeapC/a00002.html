<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Leap Motion C API: Leap Concepts</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="leapmotion-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Leap Motion C API
   &#160;<span id="projectnumber">3.1</span>
   </div>
   <div id="projectbrief">The API to the LeapC library.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>LeapC</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li class="current"><a href="pages.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00002.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Leap Concepts </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#coordinate_concept">Coordinate System</a></li>
<li class="level1"><a href="#frame_concept">Frame</a><ul><li class="level2"><a href="#frame_interpolation_concept">Frame Interpolation</a></li>
<li class="level2"><a href="#clock_concept">Clock Rebasing</a></li>
</ul>
</li>
<li class="level1"><a href="#hand_concept">Hand</a><ul><li class="level2"><a href="#digit_concept">Digit/Finger</a></li>
<li class="level2"><a href="#bone_concept">Bone</a></li>
<li class="level2"><a href="#arm_concept">Arm</a></li>
</ul>
</li>
<li class="level1"><a href="#vector_concept">Vector</a></li>
<li class="level1"><a href="#quaternion_concept">Quaternion</a></li>
<li class="level1"><a href="#image_concept">Images</a><ul><li class="level2"><a href="#distortion_map_concept">Distortion Map</a></li>
</ul>
</li>
<li class="level1"><a href="#policy_concept">Policy</a></li>
<li class="level1"><a href="#config_concept">Config Settings</a></li>
<li class="level1"><a href="#device_concept">Device</a></li>
<li class="level1"><a href="#connection_concept">Connection</a></li>
<li class="level1"><a href="#event_concept">Events/Messages</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="coordinate_concept"></a>
Coordinate System</h1>
<p>The Leap Motion system employs a right-handed Cartesian coordinate system. The origin is centered at the top of the Leap Motion Controller. The x- and z-axes lie in the plane of the camera sensors, with the x-axis running along the camera baseline. The y-axis is vertical, with positive values increasing upwards (in contrast to the downward orientation of most computer graphics coordinate systems). The z-axis has positive values increasing toward the user.</p>
<div class="image">
<img src="Leap_Axes.png" alt="Leap_Axes.png"/>
</div>
<p>The Leap Motion API measures physical quantities with the following units:</p>
<ul>
<li>Distance: millimeters</li>
<li>Time: microseconds (unless otherwise noted)</li>
<li>Speed: millimeters/second</li>
<li>Angle: radians</li>
</ul>
<h1><a class="anchor" id="frame_concept"></a>
Frame</h1>
<p>A Frame is the collection of tracking data derived from a single stereo-pair of images. The Leap Motion service/daemon software analyzes each pair of stereo images from the device sensors to detect the presense, posture, and motion of hands. This data is transmitted as a <a class="el" href="a00029.html#a00069" title="A snapshot, or frame of data, containing the tracking data for a single moment in time...">LEAP_TRACKING_EVENT</a> struct. The images used to create the frame of data can be requested separately.</p>
<p>The Leap Motion software analyzes the images and fits an internal model of the human hand to the observed scene. If parts of a hand are occluded or out of view, the software estimates the data based on what is visible, past observations, and model constraints.</p>
<p>You get <a class="el" href="a00029.html#a00069" title="A snapshot, or frame of data, containing the tracking data for a single moment in time...">LEAP_TRACKING_EVENT</a> objects by calling <a class="el" href="a00036.html#ga2a8aecad339f0fd339ca22a3e7b389f6" title="Polls the connection for a new event. ">LeapPollConnection()</a> or <a class="el" href="a00036.html#ga7cbdc29069fbcd6aca1a16989722e85c" title="Constructs a frame at the specified timestamp by interpolating between measured frames. ">LeapInterpolateFrame()</a>.</p>
<h2><a class="anchor" id="frame_interpolation_concept"></a>
Frame Interpolation</h2>
<p>Frame interpolation uses the nearest frame data to synthesize a new frame at a specified time. If this specified time is between two past frames, the data of these two frames is interpolated to synthesize an intermediate frame. If the specified time is more recent than the latest frame, then the new frame is synthesized by extrapolating the most recent data. Extrapolation can reduce latency between the motion of the hand and the corresponding change in the graphical display &ndash; especially on systems that double or triple buffer rendering frames. However, extrapolating too far in the future can lead to jerky motion and other artifacts.</p>
<p>Request an interpolated frame with <a class="el" href="a00036.html#ga7cbdc29069fbcd6aca1a16989722e85c" title="Constructs a frame at the specified timestamp by interpolating between measured frames. ">LeapInterpolateFrame()</a>. Past tracking data is only kept for a few frames. If you attempt to interpolate too far in the past, then this function will return an error.</p>
<p>See <a class="el" href="a00024.html#interpolatingframes">Interpolating Frames</a> for more information and <a class="el" href="a00012.html">Interpolated Frames Example</a> for code samples.</p>
<h2><a class="anchor" id="clock_concept"></a>
Clock Rebasing</h2>
<p>When requesting interpolated frames, you must specify the time for the desired frame. This time must be provided in terms of the internal clock used by the Leap Motion software. You can use <a class="el" href="a00036.html#ga4ef33708af974ecd618ad9784aa38161" title="Samples the universal clock used by the system to timestamp image and tracking frames. ">LeapGetNow()</a> to get the current Leap time, but if you are synchronizing frames with an application clock, you can use clock rebasing to synchronize the aLeap and application clocks. When the two clocks are synchronized, you can use the function <a class="el" href="a00036.html#gadd9e1af6480d7948b77ccf40fbca337a" title="Computes the Leap Motion clock corresponding to a specified application clock value. ">LeapRebaseClock()</a> to translate the application clock to the Leap Motion clock.</p>
<p>To use clock rebasing, create a <a class="el" href="a00029.html#a00039" title="An opaque clock rebase state structure. ">LEAP_CLOCK_REBASER</a> object with <a class="el" href="a00036.html#ga95c0d7e31b8337021c41f13d4ef6849b" title="Initializes a new Leap clock-rebaser handle object. ">LeapCreateClockRebaser()</a>. Maintain synchronization between the clocks by calling <a class="el" href="a00036.html#gac111f105a4b418e1f7ed08a1b74c8bca" title="Updates the relationship between the Leap Motion clock and the user clock. ">LeapUpdateRebase()</a> as often as possible, ideally every time you request a frame of data.</p>
<p>See <a class="el" href="a00012.html">Interpolated Frames Example</a> for code samples.</p>
<h1><a class="anchor" id="hand_concept"></a>
Hand</h1>
<p>Hands are the primary focus of the Leap Motion tracking data. The <a class="el" href="a00029.html#a00057" title="Describes a tracked hand. ">LEAP_HAND</a> struct is the parent of the physical tracking data measured for an individual hand. In addition to its own position and orientation, the hand provides access to the objects representing the digits and arm attached to that hand.</p>
<p>Get hand data from a <a class="el" href="a00029.html#a00069" title="A snapshot, or frame of data, containing the tracking data for a single moment in time...">LEAP_TRACKING_EVENT</a> object.</p>
<h2><a class="anchor" id="digit_concept"></a>
Digit/Finger</h2>
<p>Fingers are represented by the <a class="el" href="a00029.html#a00054" title="Describes the digit of a hand. ">LEAP_DIGIT</a> struct. Fingers are made up of four bones: metacarpal, proximal phalange, intermediate phalange, and distal phalange, in that order, from hand to tip. One thing to note, is that the thumb uses the same bones as the other fingers, even though an anatomical thumb has no intermediate phalange. To compensate, the Leap Motion model of the thumb has a zero-length metacarpal bone.</p>
<div class="image">
<img src="hand_bones.svg" alt="hand_bones.svg"/>
</div>
<h2><a class="anchor" id="bone_concept"></a>
Bone</h2>
<p>The segments of the fingers are represented by <a class="el" href="a00029.html#a00038" title="Describes a bone&#39;s position and orientation. ">LEAP_BONE</a> structs. There are four bones per finger:</p>
<ul>
<li>metacarpal</li>
<li>proximal phalange</li>
<li>intermediate phalange</li>
<li>distal phalange</li>
</ul>
<p>A bone has two endpoints, a quaternion representing its orientation, and a width. Other physical quantities, such as length and direction, can be calculated from these values.</p>
<h2><a class="anchor" id="arm_concept"></a>
Arm</h2>
<p>The arm is represented by the <a class="el" href="a00029.html#a00038" title="Describes a bone&#39;s position and orientation. ">LEAP_BONE</a> struct. Given the centrality of the hand to the Leap Motion hand tracking system, the arm is a child of the hand, rather than vice versa.</p>
<h1><a class="anchor" id="vector_concept"></a>
Vector</h1>
<p>The <a class="el" href="a00029.html#a00071" title="A three element, floating-point vector. ">LEAP_VECTOR</a> struct is a three-element vector used to store positions, directions, velocities, and other coordinates. The <a class="el" href="a00029.html#a00071" title="A three element, floating-point vector. ">LEAP_VECTOR</a> struct has no functions for performing vector math.</p>
<h1><a class="anchor" id="quaternion_concept"></a>
Quaternion</h1>
<p>The <a class="el" href="a00029.html#a00066" title="A four element, floating point quaternion. ">LEAP_QUATERNION</a> struct is a four-element vector used to store rotations. The <a class="el" href="a00029.html#a00066" title="A four element, floating point quaternion. ">LEAP_QUATERNION</a> struct has no functions for performing quaternion operations.</p>
<h1><a class="anchor" id="image_concept"></a>
Images</h1>
<p>The Leap Motion system currently uses two monochrome, IR cameras as its primary sensors. You can request images with the <a class="el" href="a00036.html#gaf157e7c0438fec45851069189735e672" title="Requests an image from the service. ">LeapRequestImages()</a> function, supplying a buffer to be filled in with the image data. When the buffer is written, the <a class="el" href="a00029.html#a00058" title="The properties of a requested Image. ">LEAP_IMAGE_COMPLETE_EVENT</a> struct is provided by the <a class="el" href="a00036.html#ga2a8aecad339f0fd339ca22a3e7b389f6" title="Polls the connection for a new event. ">LeapPollConnection()</a> function. The image complete event also contains image properties, such as width, height, and the distortion map.</p>
<p>The image buffer is filled in with images from both cameras. The left image is first; followed by the second. Current devices use one byte per pixel, representing the recorded brightness value at that pixel. Future devices may provide different pixel formats. Image resolution can change dynamically and varies by device type, settings, and operating modes.</p>
<p>Different Leap Motion hardware can support different image formats &ndash; although all currently available devices support only the monochrome, 1-byte-per-pixel format. Future devices may support different formats. The format and number of bytes per pixel of an image are provided by the <a class="el" href="a00029.html#a00062" title="Properties of a sensor image. ">LEAP_IMAGE_PROPERTIES</a> struct.</p>
<p>See <a class="el" href="a00026.html#requestimage">Requesting Images</a> for more information.</p>
<h2><a class="anchor" id="distortion_map_concept"></a>
Distortion Map</h2>
<p>The distortion map can be used to rectify an image so that the brightness value of a pixel represents the true value entering the camera after correcting for lens distortions. The distortion map is a 64x64 grid of 32bit floating point coordinates. Each point in the map has an x and y coordinate that represents the location in the image data to find the true brightness value. For points in between the grid centers, you can use bilinear interpolation. In fact, the distortion map is defined this way to take advantage of GPU texture map interpolation. Rectifying an image without a GPU is generally too slow for real-time systems. However, you can use the <a class="el" href="a00036.html#gacc6a5c80f87a60c63889407a45a3344b" title="Provides the corrected camera ray intercepting the specified point on the image. ">LeapPixelToRectilinear()</a> function to rectify individual points.</p>
<p>See <a class="el" href="a00026.html#imagedistortion">Image Distortion</a> for more information.</p>
<h1><a class="anchor" id="policy_concept"></a>
Policy</h1>
<p>Policies are Leap Motion system settings that can affect not just your own application, but any running Leap-enabled application. There are currently three defined policies (enumerated by the eLeapPolicyFlag enum):</p>
<ul>
<li>Background frames policy – whether the current application should access tracking data when it is not the focused, frontmost application on the computer. This policy is controlled by the Allow Background Apps setting in the Leap Motion Control panel. Note that the LeapC library does not enforce this policy – tracking frames are provided whether or not this policy is set. You can use the current value of the policy to indicate whether the user wants apps to get frames in the background.</li>
<li>Optimize for HMD policy – whether the Leap Motion service software expects to see hands from the HMD or the desktop perspective. Matching this policy to the current perspective – in other words, setting the policy to true when using a head-mounted display and false when using the device placed on a desktop – greatly improves the quality of tracking. This policy affects all applications that use Leap Motion tracking data.</li>
<li>Allow pause and resume policy – whether applications can individually pause and resume tracking. This policy affects all applications that use Leap Motion tracking data. It is generally unnecessary for an individual application to control service tracking. You can simply ignore incoming frames to effectively "pause" tracking within the scope of an application – and this won't prevent other applications from receiving data. Pausing tracking may decrease the CPU usage of the Leap Motion service/daemon, so pausing tracking may make sense to save CPU and power resources on resource-constrained devices.</li>
</ul>
<p>Setting and getting policies is asynchronous and may fail. When you call LeapSetPolicyFlags to read or write a policy, <a class="el" href="a00036.html#ga2a8aecad339f0fd339ca22a3e7b389f6" title="Polls the connection for a new event. ">LeapPollConnection()</a> will provide a <a class="el" href="a00029.html#a00065" title="The response from a request to get or set a policy. ">LEAP_POLICY_EVENT</a> when the policy change has been processed. Compare the desired policy flags with the active policy flags in the <a class="el" href="a00029.html#a00065" title="The response from a request to get or set a policy. ">LEAP_POLICY_EVENT</a> struct to determine whether the policy change succeeded.</p>
<p>See <a class="el" href="a00024.html#policies">Controlling Policies</a> for information about setting and checking policies.</p>
<h1><a class="anchor" id="config_concept"></a>
Config Settings</h1>
<p>The Leap Motion software has a number of configuration settings. Some settings reflect the user options in the control panel, other settings reflect default, but changeable configuration values assigned in the config.json files read at system startup, still others are experimental software switches intended for internal use only. Only use documented settings in your applications. Leap Motion may remove or change non-documented settings without notice.</p>
<p>Setting and reading configuration values is asynchronous and may fail. When you call <a class="el" href="a00036.html#ga6fdd92015369e64bc8d09d1cbc77fb46" title="Requests the current value of a service configuration setting. ">LeapRequestConfigValue()</a> to read a setting, <a class="el" href="a00036.html#ga2a8aecad339f0fd339ca22a3e7b389f6" title="Polls the connection for a new event. ">LeapPollConnection()</a> will provide a <a class="el" href="a00029.html#a00041" title="Contains the response to a configuration value request. ">LEAP_CONFIG_RESPONSE_EVENT</a> when the value is available. Similarly, when you write a config value with <a class="el" href="a00036.html#ga8f80709d76bd235949e295055cd3bf9d" title="Causes the client to commit a configuration change to the Leap Motion service. ">LeapSaveConfigValue()</a>, <a class="el" href="a00036.html#ga2a8aecad339f0fd339ca22a3e7b389f6" title="Polls the connection for a new event. ">LeapPollConnection()</a> provides a <a class="el" href="a00029.html#a00040" title="The result of a configuration change request. ">LEAP_CONFIG_CHANGE_EVENT</a>, which reports whether the change was successful.</p>
<p>See <a class="el" href="a00024.html#config">Getting and Setting Configuration Values</a> and <a class="el" href="a00004.html">Configuration</a> for more information.</p>
<h1><a class="anchor" id="device_concept"></a>
Device</h1>
<p>The <a class="el" href="a00029.html#a00051" title="Properties of a Leap device. ">LEAP_DEVICE_INFO</a> struct provides information about the capabilities of the attached Leap Motion hardware. Rather than hard-coding the capabilities based on your current device, you can use the device info struct to provide a measure of reiliance against future changes. The key capabilities include:</p>
<ul>
<li>The baseline distance between the two cameras.</li>
<li>The horizontal field of view of the sensors.</li>
<li>The vertical field of view of the sensors.</li>
<li>The estimated reliable tracking range.</li>
</ul>
<p>See <a class="el" href="a00024.html#devices">Reading Device Properties</a> for information on accessing device information.</p>
<h1><a class="anchor" id="connection_concept"></a>
Connection</h1>
<p>The primary Leap Motion software operates as a service (on Windows) or a daemon (on Mac, Linux, and Android). The LeapC library connects to this service/daemon when you create and open a connection.</p>
<p>See <a class="el" href="a00024.html#messagepump">Getting Tracking Frames and Other Event Messages</a> for more inormation about creating and opening connections. See <a class="el" href="a00006.html">Examples</a> for code samples.</p>
<h1><a class="anchor" id="event_concept"></a>
Events/Messages</h1>
<p>As events occur in the Leap Motion service/daemon, they are added to an event queue. <a class="el" href="a00036.html#ga2a8aecad339f0fd339ca22a3e7b389f6" title="Polls the connection for a new event. ">LeapPollConnection()</a> reads this queue and populates the <a class="el" href="a00029.html#a00047" title="Defines a basic message from the LeapC message queue. ">LEAP_CONNECTION_MESSAGE</a> struct type relevant to the event. For example, when a tracking frame is generated by the service, <a class="el" href="a00036.html#ga2a8aecad339f0fd339ca22a3e7b389f6" title="Polls the connection for a new event. ">LeapPollConnection()</a> provides a <a class="el" href="a00029.html#a00069" title="A snapshot, or frame of data, containing the tracking data for a single moment in time...">LEAP_TRACKING_EVENT</a> embedded in the <a class="el" href="a00029.html#a00047" title="Defines a basic message from the LeapC message queue. ">LEAP_CONNECTION_MESSAGE</a> struct. If you don't poll the connection fast enough, messages will be discarded.</p>
<p>See <a class="el" href="a00024.html#messagepump">Getting Tracking Frames and Other Event Messages</a> for more inormation about accessing tracking events. See <a class="el" href="a00006.html">Examples</a> for code samples. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">LeapC</a></li>
    <li class="footer">Generated on Tue Dec 13 2016 15:48:45 for Leap Motion C API by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
